<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tital Eye+ Style Studio</title>
    <meta name="description" content="Tital Eye+ Style Studio." />
    <meta
      name="keywords"
      content="titanplus, eyeware, recommendation, eyeware-recommendation"
    />
    <meta name="author" content="Tital Eye+" />
    <meta
      http-equiv="Permissions-Policy"
      content="xr-spatial-tracking=(self)"
    />

    <!-- Favicon -->
    <link
      rel="icon"
      type="image/png"
      href="https://cdn.pixelbin.io/v2/dummy-cloudname/t.resize(h:90,w:90)/__glam_ar/_titan/titanplus.png"
    />
    <link
      rel="shortcut icon"
      type="image/png"
      href="https://cdn.pixelbin.io/v2/dummy-cloudname/t.resize(h:90,w:90)/__glam_ar/_titan/titanplus.png"
    />
    <link
      rel="apple-touch-icon"
      href="https://cdn.pixelbin.io/v2/dummy-cloudname/t.resize(h:90,w:90)/__glam_ar/_titan/titanplus.png"
    />

    <!-- Open Graph / Social Media Meta Tags -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content="GlamAR Eye Recommendation" />
    <meta property="og:description" content="Tital Eye+ Style Studio." />
    <meta
      property="og:image"
      content="https://cdn.pixelbin.io/v2/dummy-cloudname/t.resize(h:90,w:90)/__glam_ar/_titan/titanplus.png"
    />

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="GlamAR Eye Recommendation" />
    <meta name="twitter:description" content="Tital Eye+ Style Studio." />
    <meta
      name="twitter:image"
      content="https://cdn.pixelbin.io/v2/dummy-cloudname/t.resize(h:90,w:90)/__glam_ar/_titan/titanplus.png"
    />
  </head>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      background-color: black;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
        Ubuntu, Cantarell, sans-serif;
      min-height: 100vh;
      overflow: hidden;
      margin: 0;
      padding: 0;
      background: white;
    }

    /* Allow body scrolling in iPad landscape mode */
    @media screen and (min-width: 1024px) and (max-width: 1366px) and (orientation: landscape) {
      body {
        overflow: auto;
        -webkit-overflow-scrolling: touch;
      }
    }

    /* Default container styles for desktop/web */
    #GlamAR-Container {
      width: 700px;
      height: 800px;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 1;
      background: #ffffff;
      border-radius: 0;
      overflow: hidden;
    }

    /* iPad Portrait Mode - Full width/height with bottom margin */
    @media screen and (min-width: 768px) and (max-width: 1024px) and (orientation: portrait) {
      #GlamAR-Container {
        width: 100vw;
        height: calc(
          100vh - 80px
        ); /* 80px bottom margin to prevent UI hiding */
        position: fixed;
        top: 0;
        left: 0;
        transform: none;
        margin-bottom: 80px;
      }
    }

    /* iPad Landscape Mode - Fixed width/height centered with scrolling */
    @media screen and (min-width: 1024px) and (max-width: 1366px) and (orientation: landscape) {
      #GlamAR-Container {
        width: 1024px;
        height: 768px;
        max-height: 100vh;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        margin: 0;
        overflow-y: auto;
        overflow-x: hidden;
        -webkit-overflow-scrolling: touch;
      }
    }

    /* VTO Live Container - Responsive based on parent container */
    [class*="vtoLiveContainer"] {
      position: fixed !important;
      top: 0 !important;
      left: 0 !important;
      width: 100vw !important;
      height: 100vh !important;
      z-index: 1000 !important;
      background: white !important;
      border-radius: 0 !important;
      overflow: hidden !important;
    }

    /* iPad Portrait - VTO container respects parent with bottom margin */
    @media screen and (min-width: 768px) and (max-width: 1024px) and (orientation: portrait) {
      [class*="vtoLiveContainer"],
      div[class*="vtoLiveContainer"],
      div[id*="renderWindow"] {
        width: 100vw !important;
        height: calc(100vh - 80px) !important;
        top: 0 !important;
        left: 0 !important;
        transform: none !important;
        margin-bottom: 80px !important;
      }
    }

    /* iPad Landscape - VTO container uses fixed dimensions with scrolling */
    @media screen and (min-width: 1024px) and (max-width: 1366px) and (orientation: landscape) {
      [class*="vtoLiveContainer"],
      div[class*="vtoLiveContainer"],
      div[id*="renderWindow"] {
        width: 1024px !important;
        height: 768px !important;
        max-height: 100vh !important;
        top: 50% !important;
        left: 50% !important;
        transform: translate(-50%, -50%) !important;
        margin: 0 !important;
        overflow-y: auto !important;
        overflow-x: hidden !important;
        -webkit-overflow-scrolling: touch !important;
      }

      /* Ensure nested scrollable content works */
      #GlamAR-Container iframe,
      #GlamAR-Container > div,
      [class*="vtoLiveContainer"] iframe,
      [class*="vtoLiveContainer"] > div {
        overflow-y: auto !important;
        -webkit-overflow-scrolling: touch !important;
      }
    }

    /* Additional selectors for VTO containers */
    div[class*="vtoLiveContainer"],
    div[id*="renderWindow"] {
      position: fixed !important;
      top: 0 !important;
      left: 0 !important;
      width: 100vw !important;
      height: 100vh !important;
      z-index: 1000 !important;
      background: white !important;
      border-radius: 0 !important;
      overflow: hidden !important;
    }
  </style>
  <script src="https://cdn.glamarz0.de/sdk/wrapper?"></script>
  <body>
    <div id="GlamAR-Container"></div>
  </body>
  <script>
    // Detect iPad
    const isIPad =
      /iPad|iPhone|iPod/.test(navigator.userAgent) ||
      (navigator.platform === "MacIntel" && navigator.maxTouchPoints > 1);

    // Function to update VTO container styles based on orientation
    function updateVTOContainers() {
      const isPortrait = window.innerHeight > window.innerWidth;
      const isLandscape = window.innerWidth > window.innerHeight;

      const vtoContainers = document.querySelectorAll(
        '[class*="vtoLiveContainer"], [id*="renderWindow"]'
      );

      vtoContainers.forEach((container) => {
        if (isIPad) {
          if (isPortrait) {
            // Portrait: Full width/height with bottom margin
            container.style.cssText = `
              position: fixed !important;
              top: 0 !important;
              left: 0 !important;
              width: 100vw !important;
              height: calc(100vh - 80px) !important;
              z-index: 1000 !important;
              background: white !important;
              border-radius: 0 !important;
              overflow: hidden !important;
              transform: none !important;
              margin-bottom: 80px !important;
            `;
          } else if (isLandscape) {
            // Landscape: Fixed dimensions centered with scrolling
            container.style.cssText = `
              position: fixed !important;
              top: 50% !important;
              left: 50% !important;
              width: 1024px !important;
              height: 768px !important;
              max-height: 100vh !important;
              z-index: 1000 !important;
              background: white !important;
              border-radius: 0 !important;
              overflow-y: auto !important;
              overflow-x: hidden !important;
              -webkit-overflow-scrolling: touch !important;
              transform: translate(-50%, -50%) !important;
              margin: 0 !important;
            `;

            // Enable scrolling on nested elements
            const nestedElements = container.querySelectorAll(
              'iframe, div, [class*="scroll"], [class*="content"]'
            );
            nestedElements.forEach((el) => {
              if (el.offsetHeight > container.offsetHeight) {
                el.style.overflowY = "auto";
                el.style.webkitOverflowScrolling = "touch";
              }
            });
          }
        } else {
          // Desktop/Web: Full screen
          container.style.cssText = `
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100vw !important;
            height: 100vh !important;
            z-index: 1000 !important;
            background: white !important;
            border-radius: 0 !important;
            overflow: hidden !important;
          `;
        }
      });
    }

    // Observer to watch for dynamically created VTO containers
    const observer = new MutationObserver(() => {
      updateVTOContainers();
    });

    // Start observing
    observer.observe(document.body, {
      childList: true,
      subtree: true,
    });

    // Handle orientation and resize changes
    function handleOrientationChange() {
      const container = document.getElementById("GlamAR-Container");
      if (!container) return;

      const isPortrait = window.innerHeight > window.innerWidth;
      const isLandscape = window.innerWidth > window.innerHeight;

      console.log("Orientation changed:", {
        isIPad,
        isPortrait,
        isLandscape,
        width: window.innerWidth,
        height: window.innerHeight,
      });

      // Update main container
      if (isIPad) {
        if (isPortrait) {
          container.style.width = "100vw";
          container.style.height = "calc(100vh - 80px)";
          container.style.top = "0";
          container.style.left = "0";
          container.style.transform = "none";
          container.style.marginBottom = "80px";
        } else if (isLandscape) {
          container.style.width = "1024px";
          container.style.height = "768px";
          container.style.maxHeight = "100vh";
          container.style.top = "50%";
          container.style.left = "50%";
          container.style.transform = "translate(-50%, -50%)";
          container.style.marginBottom = "0";
          container.style.overflowY = "auto";
          container.style.overflowX = "hidden";
          container.style.webkitOverflowScrolling = "touch";
        }
      }

      // Update VTO containers
      setTimeout(updateVTOContainers, 100);
    }

    // Listen for orientation and resize changes
    window.addEventListener("orientationchange", () => {
      setTimeout(handleOrientationChange, 200);
    });
    window.addEventListener("resize", handleOrientationChange);

    function InitGlamAr() {
      console.log("Glamar AR ", GlamAR);

      const isPortrait = window.innerHeight > window.innerWidth;
      const isLandscape = window.innerWidth > window.innerHeight;

      console.log("Device Info:", {
        isIPad,
        isPortrait,
        isLandscape,
        width: window.innerWidth,
        height: window.innerHeight,
      });

      const config = {
        platform: "web",
        category: "eyewearrecommendation",
        meta: {
          sdkVersion: "2.0.0",
          debugText: true,
        },
      };

      GlamAR.init(
        "GlamAR-Container",
        "0cd10539-e91f-41f1-87d8-71330a1e175a",
        config
      );

      window.GlamAR.addEventListener("*", function (event, payload) {
        console.log(`GlamAR Event:`, event, payload);

        // When SDK opens/loads, update VTO containers
        if (event === "opened" || event === "loaded") {
          setTimeout(updateVTOContainers, 500);
        }
      });

      // Initial update
      handleOrientationChange();
    }

    InitGlamAr();
  </script>
</html>
