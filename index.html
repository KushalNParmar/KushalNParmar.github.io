<model-viewer
  id="dimension-demo"
  ar=""
  autoplay=""
  ar-scale="fixed"
  ar-modes="webxr scene-viewer quick-look"
  ar-status="not-presenting"
  camera-orbit="-30deg auto auto"
  max-camera-orbit="auto 100deg auto"
  shadow-intensity="1"
  camera-controls
  touch-action="pan-y"
  src="https://cdn.pixelbin.io/v2/glamar-fynd-835885/original/glamar-3d-models/West_Elm/02/Irvine_Leather_Dining_Chair.glb"
  onload="onModelLoaded()"
  alt="A 3D model of an armchair."
>
</model-viewer>

<script
  type="module"
  src="https://unpkg.com/@google/model-viewer/dist/model-viewer.js"
></script>

<script type="module">
  const modelViewer = document.querySelector("#dimension-demo");

  function onModelLoaded() {
    const modelViewer = document.getElementById("model-viewer");
    const loader = document.getElementById("progress-bar");

    // Enable AR mode immediately upon model load if it's available
    if (modelViewer && modelViewer.canActivateAR) {
      modelViewer.activateAR(); // Automatically trigger AR
    }
  }

  modelViewer.addEventListener("progress", (event) => {
    const progressBar = document.getElementById("progress-bar");
    const progress = event.detail.totalProgress;
    if (progress === 1) {
      modelViewer.addEventListener("ar-status", (arEvent) => {
        if (arEvent.detail.status === "activated") {
          // Hide loader once AR is activated
          progressBar.style.display = "none";
          // Hide 3D model viewer when AR is activated
          modelViewer.style.display = "none";
        }
      });
    }
  });
</script>

<style>
  body {
    margin: 0;
    padding: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    background-color: #f5f5f5;
    font-family: Arial, sans-serif;
  }
  model-viewer {
    width: 100%;
    height: 100%;
    max-width: 100%;
    max-height: 100%;
  }
</style>
